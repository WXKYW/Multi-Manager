<!-- 认证检查加载状态 (已移除，使用全局加载屏) -->

<!-- 首次设置密码界面 -->
<div v-if="!isCheckingAuth && showSetPasswordModal" class="auth-screen">
  <div class="auth-card">
    <div class="auth-header">
      <div class="auth-logo">
        <i class="fas fa-rocket"></i>
      </div>
      <h1>开启新旅程</h1>
      <p>请为您的管理后台设置初始密码</p>
    </div>
    <div class="auth-body">
      <div class="auth-input-group">
        <i class="fas fa-key input-icon"></i>
        <input v-model="setPassword" type="password" class="auth-input" placeholder="设置新密码 (6位以上)"
          autocomplete="new-password" @keyup.enter="setAdminPassword" />
      </div>
      <div class="auth-input-group">
        <i class="fas fa-check-double input-icon"></i>
        <input v-model="setPasswordConfirm" type="password" class="auth-input" placeholder="再次确认密码"
          autocomplete="new-password" @keyup.enter="setAdminPassword" />
      </div>
      <div v-if="setPasswordError" class="auth-error-msg">
        <i class="fas fa-info-circle"></i> {{ setPasswordError }}
      </div>
      <button @click="setAdminPassword" class="auth-primary-btn">
        <span>开始使用</span>
        <i class="fas fa-arrow-right"></i>
      </button>
    </div>
  </div>
</div>

<!-- 登录界面 -->
<div v-if="!isCheckingAuth && showLoginModal" class="auth-screen">
  <div class="auth-card">
    <div class="auth-header">
      <div class="auth-logo login-logo">
        <i class="fas" :class="loginRequire2FA ? 'fa-shield-alt' : 'fa-shield-halved'"></i>
      </div>
      <h1 v-if="isDemoMode">演示模式</h1>
      <h1 v-else-if="loginRequire2FA">双因素验证</h1>
      <h1 v-else>欢迎回来</h1>
      <p v-if="isDemoMode">账号无需密码，点击"立即进入"以继续</p>
      <p v-else-if="loginRequire2FA">请输入 Authenticator App 中的验证码</p>
      <p v-else>身份验证以访问监控面板</p>
    </div>
    <div class="auth-body">
      <!-- 密码输入（非演示模式且未进入 2FA 阶段） -->
      <div v-if="!isDemoMode && !loginRequire2FA" class="auth-input-group">
        <i class="fas fa-lock input-icon"></i>
        <input v-model="loginPassword" type="password" class="auth-input" placeholder="请输入管理员密码"
          autocomplete="current-password" autofocus @keyup.enter="verifyPassword" />
      </div>
      <!-- 2FA 验证码输入 -->
      <div v-if="loginRequire2FA" class="auth-input-group">
        <i class="fas fa-key input-icon"></i>
        <input v-model="loginTotpToken" type="text" class="auth-input" placeholder="6 位验证码" maxlength="6"
          autocomplete="one-time-code" autofocus @input="handleTotpInput" @keyup.enter="verifyPassword" />
      </div>
      <div v-if="loginError" class="auth-error-msg">
        <i class="fas fa-exclamation-triangle"></i> {{ loginError }}
      </div>
      <button v-if="!loginRequire2FA" @click="verifyPassword" class="auth-primary-btn" :disabled="loginLoading">
        <i v-if="loginLoading" class="fas fa-spinner fa-spin"></i>
        <span v-else>立即进入</span>
        <i v-if="!loginLoading" class="fas fa-sign-in-alt"></i>
      </button>
      <!-- 返回按钮（2FA 模式） -->
      <button v-if="loginRequire2FA" @click="cancelLogin2FA" class="auth-secondary-btn" title="返回密码输入">
        <i class="fas fa-chevron-left"></i> 返回修改
      </button>
    </div>
    <div class="auth-footer-decoration">
      <div class="circle c1"></div>
      <div class="circle c2"></div>
    </div>
  </div>
</div>